{
	"name": "LoadStagingDBtoRelationDB_df",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "SQLstagingfund_ds",
						"type": "DatasetReference"
					},
					"name": "StagingDB"
				},
				{
					"dataset": {
						"referenceName": "SQLrelationfund_ds",
						"type": "DatasetReference"
					},
					"name": "RelationDB"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "StatgingAddChecksum"
				},
				{
					"name": "LookupRelationalStream"
				},
				{
					"name": "RelationalAddChecksum"
				},
				{
					"name": "ConditionalSplit1"
				},
				{
					"name": "RelationRenameColumns"
				}
			],
			"script": "\n\nsource(output(\n\t\tFund_ID as string,\n\t\tFund_Name as string,\n\t\tFund_Master as string,\n\t\tFund_master_Name as string,\n\t\tFund_ABN as string,\n\t\tFund_ARSN as string,\n\t\tFund_Country as string,\n\t\tFund_Region as string,\n\t\tFund_State as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tpartitionBy('hash', 1)) ~> StagingDB\nsource(output(\n\t\tFund_ID as string,\n\t\tFund_Name as string,\n\t\tFund_Master as string,\n\t\tFund_master_Name as string,\n\t\tFund_ABN as string,\n\t\tFund_ARSN as string,\n\t\tFund_Country as string,\n\t\tFund_Region as string,\n\t\tFund_State as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT [Fund_ID]\\n      ,[Fund_Name]\\n      ,[Fund_Master]\\n      ,[Fund_master_Name]\\n      ,[Fund_ABN]\\n      ,[Fund_ARSN]\\n      ,[Fund_Country]\\n      ,[Fund_Region]\\n      ,[Fund_State]\\n  FROM [relational].[Fund]\\n  WHERE [record_deleted_flag] = 1',\n\tformat: 'query',\n\tpartitionBy('hash', 1)) ~> RelationDB\nStagingDB derive(StagingChecksum = sha2(256, Fund_ID,Fund_Name,Fund_Master,Fund_master_Name,Fund_ABN,Fund_ARSN,Fund_Country,Fund_Region,Fund_State),\n\tpartitionBy('hash', 1)) ~> StatgingAddChecksum\nStatgingAddChecksum, RelationRenameColumns lookup(StagingDB@Fund_ID == Relation_Fund_ID\n\t&& StagingDB@Fund_Master == Relation_Fund_Master,\n\tpartitionBy('hash', 1),\n\tbroadcast: 'none')~> LookupRelationalStream\nRelationDB derive(RelationalChecksum = sha2(256, Fund_ID,Fund_Name,Fund_Master,Fund_master_Name,Fund_ABN,Fund_ARSN,Fund_Country,Fund_Region,Fund_State)) ~> RelationalAddChecksum\nLookupRelationalStream split(ERROR_FUNCTION(''),\n\tdisjoint: false,\n\tpartitionBy('hash', 1)) ~> ConditionalSplit1@(, )\nRelationalAddChecksum select(mapColumn(\n\t\tRelation_Fund_ID = Fund_ID,\n\t\tRelation_Fund_Name = Fund_Name,\n\t\tRelation_Fund_Master = Fund_Master,\n\t\tRelation_Fund_master_Name = Fund_master_Name,\n\t\tRelation_Fund_ABN = Fund_ABN,\n\t\tRelation_Fund_ARSN = Fund_ARSN,\n\t\tRelation_Fund_Country = Fund_Country,\n\t\tRelation_Fund_Region = Fund_Region,\n\t\tRelation_Fund_State = Fund_State,\n\t\tRelation_RelationalChecksum = RelationalChecksum\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> RelationRenameColumns"
		}
	}
}